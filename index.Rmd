---
title: "IronyTask0607"
author: "TomoyaYAMADA"
date: "2021/6/6"
output:
  html_document:
    mathjax: null
    highlight: null
    theme: null
    css: jspsych-6.3.1/css/jspsych.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r}
library(htmltools)
tagList(
tags$script(src="https://Tim-Synnn.github.io/jsPsychSheet/jspsych-6.3.1/jspsych.js"),
tags$script(src="https://Tim-Synnn.github.io/jspsych-6.3.1/plugins/jspsych-html-keyboard-response.js"),
tags$script(src="https://Tim-Synnn.github.io/jsPsychSheet/jspsych-6.3.1/plugins/jspsych-image-keyboard-response.js"),
tags$script(src="https://Tim-Synnn.github.io/jsPsychSheet/jspsych-6.3.1/plugins/jspsych-survey-text.js"),
tags$script(src="https://Tim-Synnn.github.io/jsPsychSheet/jspsych-6.3.1/plugins/jspsych-fullscreen"),
#tags$script(src="https://Tim-Synnn.github.io/jsPsychSheet/jspsych-6.3.1/plugins/jspsych-survey-multi-choice.js"),
tags$script(src="https://Tim-Synnn.github.io/jsPsychSheet/jspsychsheet.js"),
tags$link(rel="stylesheet",href="https://Tim-Synnn.github.io/jsPsychSheet/jspsychsheet.css")
)



```


```{js}
/* create timeline */
    var timeline = [];

/* preload images */
    var preload = {
      type: 'preload',
      images: ['img/blue.png', 'img/orange.png']
    }
    timeline.push(preload);

/* define welcome message trial */
    var welcome = {
      type: "html-keyboard-response",
      stimulus: "Welcome to the experiment. Press any key to begin."
    };
    timeline.push(welcome);

// 実験の説明
var instruction = {
    type: "survey-text",
    questions: [
      {prompt: "名前をローマ字で入力して下さい？", name: 'SubName', required:"True"}
    ],
    button_label: "次へ"//次へのボタンラベルを変更（指定しないと"Continue"と表示される）
};

var instructions = {
      type: "html-keyboard-response",
      stimulus:
          "<p>この研究では画面の中央に円が表示されます。</p> +
          "<p>円が <strong>青</strong>、" +
          "の場合にはできるだけ早くFのボタンを押してください。</p>" +
          "<p>もし、円が<strong>オレンジ</strong>、だったらJのボタンを " +
          "押してください。</p>" +
          "<div style='width: 700px;'>" +
          "<div style='float: left;'>" +
            "<img src='https://Tim-Synnn.github.io/jsPsychSheet/expe/blue.png'></img>" +
          "<p class='small'><strong>Press the F key</strong></p></div>" +
          "<div class='float: right;'>" +
            "<img src='https://Tim-Synnn.github.io/jsPsychSheet/expe/orange.png'></img>" +
          "<p class='small'><strong>Press the J key</strong></p></div>" +
          "</div>"+
          "<p>Press any key to begin.</p>",
      post_trial_gap: 2000
    };

/* test trials */
    var test_stimuli = [
      { stimulus: "https://Tim-Synnn.github.io/jsPsychSheet/expe/blue.png",
        data: { test_part: 'test', correct_response: 'f' } },
      { stimulus: "https://Tim-Synnn.github.io/jsPsychSheet/expe/orange.png",
        data: { test_part: 'test', correct_response: 'j' } }
    ];

var fixation = {
      type: 'html-keyboard-response',
      stimulus: '<div style="font-size:60px;">+</div>',
      choices: jsPsych.NO_KEYS,
      trial_duration: function(){
        return jsPsych.randomization.sampleWithoutReplacement([250, 500, 750, 1000, 1250, 1500, 1750, 2000], 1)[0];
      },
      data: {
        task: 'fixation'
      }
    }

    var test = {
      type: "image-keyboard-response",
      stimulus: jsPsych.timelineVariable('stimulus'),
      choices: ['f', 'j'],
      data: {
        task: 'response',
        correct_response: jsPsych.timelineVariable('correct_response')
      },
      on_finish: function(data){
        data.correct = jsPsych.pluginAPI.compareKeys(data.response, data.correct_response);
      }
    }

    var test_procedure = {
      timeline: [fixation, test],
      timeline_variables: test_stimuli,
      repetitions: 5,
      randomize_order: true
    }
    timeline.push(test_procedure);

/* define debrief */

    var debrief_block = {
      type: "html-keyboard-response",
      stimulus: function() {

        var trials = jsPsych.data.get().filter({task: 'response'});
        var correct_trials = trials.filter({correct: true});
        var accuracy = Math.round(correct_trials.count() / trials.count() * 100);
        var rt = Math.round(correct_trials.select('rt').mean());

        return `<p>You responded correctly on ${accuracy}% of the trials.</p>
          <p>Your average response time was ${rt}ms.</p>
          <p>Press any key to complete the experiment. Thank you!</p>`;

      }
    };
    timeline.push(debrief_block);








/*選択肢
var scale = [
  "〇", 
  "✕"
];

//問題
/*var stim = [
  {
    stimulus: "<p style='color:red;font-size:60pt;'>赤</p>",
    data: { no:'1', stim_type: 'congruent', correct_key_press: 'd'}
  },
]
*/

/*リッカート尺度の質問課題を準備

var question_se1 = {
  type: 'survey-likert',
  questions: [
    {prompt: "朝起きるのが難しい", labels: scale, required: "True"}
    ],
  data: [{"rt"}
  ],
    button_label: "次へ"
};

/*var question_se2 = {
  type: 'survey-likert',
  questions: [
    {prompt: "毎日がバラのようである", labels: scale_01, required: "True"}
    ],
    button_label: "次へ"
};

var question_se3 = {
  type: 'survey-likert',
  questions: [
    {prompt: "私は人生において勝ち組である", labels: scale_01, required: "True"}
    ],
    button_label: "次へ"
};

var question_se4 = {
  type: 'survey-likert',
  questions: [
    {prompt: "何をやってもうまくいかないことが多い", labels: scale_01, required: "True"}
    ],
    button_label: "次へ"
};
*/


/*time line = 実験の順番
var timeline = [];
timeline.push(instruction);
timeline.push(instructions);
timeline.push(question_se1);
/*timeline.push(question_se2);
timeline.push(question_se3);
timeline.push(question_se4);*/

//実験の開始
jsPsych.init({
  timeline: timeline,
  on_finish: function() {
    jsPsych.data.displayData();
  //  jsPsychSheet.uploadData(jsPsych.data.get().csv());
  }
});
```
